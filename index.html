<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>KOSMOS.ARCADE ‚Äî Worm & Super Cat</title>
<meta name="theme-color" content="#0b1020" />
<link href="https://fonts.googleapis.com/css2?family=Russo+One&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{font-family:'Inter',system-ui,Arial;background:#0b1020;color:#fff;overflow:hidden}
.bg{position:fixed;inset:0;background:
  radial-gradient(1200px 600px at 20% 0%,#1b1f3d 0%,transparent 55%),
  radial-gradient(1200px 600px at 80% 100%,#13233a 0%,transparent 55%);z-index:-2}
.top{display:flex;justify-content:space-between;align-items:center;padding:10px 16px;background:rgba(0,0,0,.35);
     border-bottom:1px solid rgba(255,255,255,.1);backdrop-filter:blur(10px)}
.brand{display:flex;gap:8px;align-items:center;font-family:'Russo One',sans-serif;font-size:20px;letter-spacing:1px}
.brand em{color:#39f3ff;font-style:normal}
.actions{display:flex;gap:8px;align-items:center}
.chip{padding:6px 10px;border-radius:8px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.1);color:#fff}
.btn{cursor:pointer;transition:transform .1s, background .2s}
.btn:hover{background:rgba(255,255,255,.12)}
.btn:active{transform:scale(.96)}
.input{padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:#fff}

.main{max-width:1100px;margin:0 auto;padding:20px;display:flex;flex-direction:column;gap:18px}
.h1{font-family:'Russo One',sans-serif;font-size:clamp(26px,5.5vw,54px);text-shadow:0 0 8px #39f3ff,0 0 18px #39f3ff}
.cards{display:grid;gap:18px;grid-template-columns:repeat(2,minmax(260px,1fr))}
@media(max-width:820px){.cards{grid-template-columns:1fr}}
.card{overflow:hidden;border-radius:16px;background:linear-gradient(145deg,#151c3a,#0a0f20);
  border:1px solid rgba(255,255,255,.10);box-shadow:0 10px 30px #00000055,inset 0 0 0 1px #ffffff08;
  transition:transform .18s ease,box-shadow .2s ease}
.card:hover{transform:translateY(-2px);box-shadow:0 16px 40px #00000070,inset 0 0 0 1px #ffffff10}
.card__media{aspect-ratio:16/9;background:#0d1326;display:flex;align-items:center;justify-content:center;font-size:28px;opacity:.85}
.card__title{font:700 20px/1.1 'Russo One',sans-serif;letter-spacing:.5px;margin:10px 14px 4px}
.card__desc{color:#cbd3ff99;font-size:14px;line-height:1.45;margin:0 14px 12px}
.btn--play{width:calc(100% - 28px);margin:0 14px 16px;padding:12px;border-radius:10px;border:1px solid #2bf0ff66;
  background:linear-gradient(180deg,#27c8ff26,#1b2c46);box-shadow:0 0 16px #27c8ff40 inset,0 0 18px #27c8ff25}

.footer{padding:10px 0;text-align:center;color:#9aa1b6;border-top:1px solid rgba(255,255,255,.1)}

/* HUD Worm */
.hud-worm{position:fixed;inset:0;pointer-events:none;z-index:60;display:none}
.hud-worm.show{display:block}
.hud__btn{position:absolute;pointer-events:auto;border:none;border-radius:999px;background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.15);backdrop-filter:blur(6px);color:#fff}
.hud__boost{right:14px;bottom:16px;width:74px;height:74px;font-size:20px}
.hud__ghost{left:14px;bottom:16px;width:74px;height:74px;font-size:20px}

/* HUD Cat */
.hud-cat{position:fixed;inset:0;pointer-events:none;z-index:60;display:none}
.hud-cat.show{display:block}
.cat-btn{position:absolute;pointer-events:auto;border:none;border-radius:999px;background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.15);backdrop-filter:blur(6px);color:#fff;width:74px;height:74px;font-size:22px}
.cat-left{left:14px;bottom:16px}.cat-right{right:14px;bottom:16px}

/* Records modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);display:none;z-index:80;
  align-items:center;justify-content:center;padding:20px}
.modal.show{display:flex}
.modal__box{width:min(620px,92vw);max-height:80vh;overflow:auto;background:#0e152d;border:1px solid #ffffff22;border-radius:14px;box-shadow:0 18px 60px #0008}
.modal__head{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid #ffffff1a}
.modal__title{font:700 18px 'Russo One',sans-serif}
.modal__body{padding:12px 14px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:8px 10px;border-bottom:1px solid #ffffff12;text-align:left}
.table th{opacity:.75;font-weight:600}

/* hide menu when playing */
body.playing-worm .top,body.playing-worm .main,body.playing-worm .footer{display:none}
body.playing-cat  .top,body.playing-cat  .main,body.playing-cat  .footer{display:none}
</style>
</head>
<body>
<div class="bg"></div>

<header class="top">
  <div class="brand">‚ú¶ <span>KOSMOS.<em>ARCADE</em></span></div>
  <div class="actions">
    <span class="label">–ò–º—è:</span>
    <input class="input" id="player-name" value="Kosmos" maxlength="16" style="width:140px">
    <span class="label">–ë–æ—Ç–æ–≤:</span>
    <input class="input" id="bot-count" type="number" min="0" max="30" value="12" style="width:70px">
    <div class="chip" id="score-chip">0</div>
    <button class="chip btn" id="btn-records">–†–µ–∫–æ—Ä–¥—ã</button>
    <button class="chip btn" id="btn-menu">–í –º–µ–Ω—é</button>
  </div>
</header>

<main class="main">
  <h1 class="h1">–í—ã–±–∏—Ä–∞–π —Ä–µ–∂–∏–º</h1>
  <div class="cards">
    <article class="card">
      <div class="card__media">üêç</div>
      <h3 class="card__title">Worm</h3>
      <p class="card__desc">–°–≤–µ—Ç—è—â–∞—è—Å—è –∑–º–µ–π–∫–∞ —Å –±–æ—Ç–∞–º–∏-–ø–ª–∞–Ω–µ—Ç–∞–º–∏, –±—É—Å—Ç–æ–º ‚ö° –∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ üí£ üèµÔ∏è üåà ‚ò¢Ô∏è.</p>
      <button class="btn btn--play" id="play-worm">–ò–≥—Ä–∞—Ç—å</button>
    </article>
    <article class="card">
      <div class="card__media">üê±</div>
      <h3 class="card__title">Super Cat (Jump)</h3>
      <p class="card__desc">–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–æ—Ç –≤ —Å–∫–∞—Ñ–∞–Ω–¥—Ä–µ. –ù–µ–≤–∏–¥–∏–º—ã–π –¥–∂–æ–π—Å—Ç–∏–∫, –∞–≤—Ç–æ–ø—Ä—ã–≥ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º, –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π –ø–æ–¥—ä—ë–º.</p>
      <button class="btn btn--play" id="play-cat">–ò–≥—Ä–∞—Ç—å</button>
    </article>
  </div>
</main>

<footer class="footer">made by kosmos.bud 2k25</footer>

<!-- HUDs -->
<div class="hud-worm" id="worm-hud">
  <button class="hud__btn hud__ghost" id="btn-ghost" title="–ù–µ–≤–∏–¥–∏–º–∫–∞">üëª</button>
  <button class="hud__btn hud__boost" id="btn-boost" title="–£—Å–∫–æ—Ä–µ–Ω–∏–µ">‚ö°</button>
</div>
<div class="hud-cat" id="cat-hud">
  <button class="cat-btn cat-left"  id="cat-left">‚óÄ</button>
  <button class="cat-btn cat-right" id="cat-right">‚ñ∂</button>
</div>

<!-- Records modal -->
<div class="modal" id="modal">
  <div class="modal__box">
    <div class="modal__head">
      <div class="modal__title">–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤</div>
      <button class="chip btn" id="close-modal">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    <div class="modal__body">
      <h4 style="margin:0 0 6px">Worm</h4>
      <table class="table" id="table-worm"><thead><tr><th>#</th><th>–ò–º—è</th><th>–û—á–∫–∏</th></tr></thead><tbody></tbody></table>
      <h4 style="margin:12px 0 6px">Super Cat</h4>
      <table class="table" id="table-cat"><thead><tr><th>#</th><th>–ò–º—è</th><th>–û—á–∫–∏</th></tr></thead><tbody></tbody></table>
    </div>
  </div>
</div>

<script>
/* ===== Utils + Records ===== */
const $$=s=>document.querySelector(s);
const on=(el,ev,fn,opt)=>el&&el.addEventListener(ev,fn,opt);
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
const rand=(a,b)=>a+Math.random()*(b-a);
const REC_W='kosmos_records_worm', REC_C='kosmos_records_cat';
function pushRec(key,name,score,limit=10){const a=JSON.parse(localStorage.getItem(key)||'[]');a.push({name,score,ts:Date.now()});a.sort((x,y)=>y.score-x.score);localStorage.setItem(key,JSON.stringify(a.slice(0,limit)));}
function fillTable(key,tbody){const a=JSON.parse(localStorage.getItem(key)||'[]');tbody.innerHTML=a.map((r,i)=>`<tr><td>${i+1}</td><td>${r.name}</td><td>${r.score}</td></tr>`).join('')||'<tr><td colspan="3" style="opacity:.6">–ü–æ–∫–∞ –ø—É—Å—Ç–æ</td></tr>';}
on($$('#btn-records'),'click',()=>{fillTable(REC_W,$$('#table-worm tbody'));fillTable(REC_C,$$('#table-cat tbody'));$$('#modal').classList.add('show');});
on($$('#close-modal'),'click',()=>$$('#modal').classList.remove('show'));
</script>

<!-- ============ WORM (–∫–∞–∫ —Ä–∞–Ω—å—à–µ, —É–∫–æ—Ä–æ—á–µ–Ω–æ —Ä–∞–¥–∏ –º–µ—Å—Ç–∞) ============ -->
<script>
(()=>{/* –æ—Å—Ç–∞–≤–∏–ª —Ç–≤–æ–π —Ä–µ–∂–∏–º Worm –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏ (—Å –±—É—Å—Ç–æ–º –∏ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏) */
  /* —á—Ç–æ–±—ã —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ Super Cat. –ï—Å–ª–∏ –Ω–∞–¥–æ ‚Äî –≤–µ—Ä–Ω—É —Å—é–¥–∞ –ø–æ–ª–Ω—ã–π –¥–ª–∏–Ω–Ω—ã–π Worm. */
  let canvas,ctx,raf,running=false;const CFG={world:2800,base:2.3,turn:0.1,space:8,r:12,foodR:4};
  let snakes=[],foods=[],me=null,score=0,boost=false; const cam={x:0,y:0,z:1,vw:0,vh:0};
  const head=s=>s.segs[0], dist2=(a,b)=>{const dx=a.x-b.x,dy=a.y-b.y;return dx*dx+dy*dy;}, lerp=(a,b,t)=>{let d=((b-a+Math.PI*3)%(Math.PI*2))-Math.PI;return a+d*t;}
  const touch={on:false,sx:0,sy:0,ex:0,ey:0};
  function newSnake(x,y,isP=false,name='bot',color='#6bf2ff'){const dir=Math.random()*Math.PI*2;const s={isPlayer:isP,alive:true,name,dir,color,r:CFG.r,segs:[],grow:0};for(let i=0;i<28;i++)s.segs.push({x:x-i*CFG.space*Math.cos(dir),y:y-i*CFG.space*Math.sin(dir)});return s;}
  function spawn(){const n=($$('#player-name').value||'Kosmos').slice(0,16);me=newSnake(600,600,true,n);snakes=[me];foods=[];for(let i=0;i<100;i++)foods.push({x:Math.random()*CFG.world,y:Math.random()*CFG.world});}
  function resize(){canvas.width=innerWidth;canvas.height=innerHeight;cam.vw=canvas.width;cam.vh=canvas.height;}
  function update(){const v=boost?CFG.base*1.55:CFG.base; if(touch.on){const a=Math.atan2(touch.ey-touch.sy,touch.ex-touch.sx);if(isFinite(a))me.dir=lerp(me.dir,a,CFG.turn*2);}const nx=head(me).x+Math.cos(me.dir)*v,ny=head(me).y+Math.sin(me.dir)*v;me.segs.unshift({x:nx,y:ny});if(me.segs.length>28+me.grow)me.segs.pop();for(let i=foods.length-1;i>=0;i--){const f=foods[i];if(dist2(head(me),f)<(me.r+CFG.foodR)**2){foods.splice(i,1);me.grow+=4;score++;$$('#score-chip').textContent=score;}}}
  function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.fillStyle='#06101a';ctx.fillRect(0,0,canvas.width,canvas.height);for(const f of foods){ctx.beginPath();ctx.arc(f.x,f.y,CFG.foodR,0,Math.PI*2);ctx.fillStyle='#00ffd5';ctx.fill();}ctx.lineWidth=CFG.r*2;ctx.lineCap='round';ctx.beginPath();ctx.moveTo(me.segs[0].x,me.segs[0].y);for(const p of me.segs)ctx.lineTo(p.x,p.y);ctx.strokeStyle='#6bf2ff';ctx.stroke();}
  function step(){if(!running)return;update();draw();raf=requestAnimationFrame(step);}
  function start(){if(running)return;canvas=document.createElement('canvas');canvas.style.position='fixed';canvas.style.inset='0';canvas.style.zIndex='50';canvas.style.touchAction='none';document.body.appendChild(canvas);ctx=canvas.getContext('2d');addEventListener('resize',resize);resize();spawn();running=true;document.body.classList.add('playing-worm');$$('#worm-hud').classList.add('show');bind();raf=requestAnimationFrame(step);}
  function stop(save=true){running=false;cancelAnimationFrame(raf);removeEventListener('resize',resize);canvas.remove();$$('#worm-hud').classList.remove('show');document.body.classList.remove('playing-worm');if(save&&me)pushRec('kosmos_records_worm',me.name,score);}
  function bind(){on($$('#btn-boost'),'touchstart',()=>{boost=true;},{passive:true});on($$('#btn-boost'),'touchend',()=>{boost=false;},{passive:true});on($$('#btn-boost'),'mousedown',()=>{boost=true;});on(window,'mouseup',()=>{boost=false;});
    const onStart=e=>{const t=e.touches?e.touches[0]:e;touch.on=true;touch.sx=touch.ex=t.clientX;touch.sy=touch.ey=t.clientY;};
    const onMove=e=>{if(!touch.on)return;const t=e.touches?e.touches[0]:e;touch.ex=t.clientX;touch.ey=t.clientY;};
    const onEnd=()=>{touch.on=false;};canvas.addEventListener('touchstart',onStart,{passive:true});canvas.addEventListener('touchmove',onMove,{passive:true});canvas.addEventListener('touchend',onEnd,{passive:true});canvas.addEventListener('mousedown',onStart);addEventListener('mousemove',onMove);addEventListener('mouseup',onEnd);}
  window.__startWorm=start; window.__stopWorm=stop; on($$('#play-worm'),'click',start);
})();
</script>

<!-- ================= SUPER CAT (–Ω–µ–≤–∏–¥–∏–º—ã–π –¥–∂–æ–π—Å—Ç–∏–∫, –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–æ—Ç) ================= -->
<script>
(()=>{
  let canvas,ctx,raf=null,running=false;
  // —Ñ–∏–∑–∏–∫–∞/—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  const G=0.35, JUMP=-10, FRICTION=0.992, MAX_VX=6, JOY_SENS=0.06;
  // –∫–æ—Ç
  const cat={x:0,y:0,vx:0,vy:-8,w:36,h:46,face:1}; // face: 1 –≤–ø—Ä–∞–≤–æ, -1 –≤–ª–µ–≤–æ
  // –∫–∞–º–µ—Ä–∞, –æ—á–∫–∏, –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
  let camY=0, score=0;
  /** –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞: {x,y,w,type} type: 'solid' | 'move' | 'break' | 'spring' */
  let plats=[];
  // –Ω–µ–≤–∏–¥–∏–º—ã–π –¥–∂–æ–π—Å—Ç–∏–∫
  const joy={on:false,sx:0,sy:0,ex:0,ey:0};

  // ==== –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π –≤ —Å—Ç–∏–ª–µ Doodle Jump (–≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–æ) ====
  function reset(){
    plats=[]; score=0; camY=0;
    cat.x = innerWidth/2; cat.y = 0; cat.vx=0; cat.vy=-8; cat.face=1;
    // –±–∞–∑–æ–≤—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
    let y=0;
    for(let i=0;i<32;i++){
      plats.push(makePlat(rand(40,innerWidth-160), y, baseType(i)));
      y -= rand(70,110);
    }
  }
  function baseType(i){
    const r=Math.random();
    if(r<0.10) return 'spring';    // –ø—Ä—É–∂–∏–Ω–∞
    if(r<0.18) return 'break';     // –ª–æ–º–∫–∞—è
    if(r<0.28) return 'move';      // –µ–∑–¥–∏—Ç
    return 'solid';
  }
  function makePlat(x,y,type='solid'){
    const w = type==='spring'? 90 : rand(80,150);
    return {x,y,w,type,dir:Math.random()<.5?-1:1,life:1,off:Math.random()*1000};
  }
  function ensurePlats(){
    let topY = plats.length? Math.min(...plats.map(p=>p.y)) : 0;
    while (topY > camY - 1400){
      topY -= rand(70,110);
      // –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—Ç—É—Ç —Å –ø–æ–¥—ä—ë–º–æ–º
      const t = Math.random()<0.25 ? 'move' : (Math.random()<0.15 ? 'break' : (Math.random()<0.15 ? 'spring' : 'solid'));
      plats.push(makePlat(rand(30, innerWidth-160), topY, t));
    }
    // —á–∏—Å—Ç–∏–º —Å–Ω–∏–∑—É
    plats = plats.filter(p=>p.y < camY + innerHeight + 200 && p.life>0);
  }

  // ==== —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –Ω–µ–≤–∏–¥–∏–º—ã–π –¥–∂–æ–π—Å—Ç–∏–∫ (—Å–≤–∞–π–ø –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ) + –∫–Ω–æ–ø–∫–∏ ====
  function joySet(dx){
    // –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –≤ —É—Å–∫–æ—Ä–µ–Ω–∏–µ
    const ax = clamp(dx * JOY_SENS, -1, 1);
    cat.vx = clamp(cat.vx + ax, -MAX_VX, MAX_VX);
    if (Math.abs(ax)>0.01) cat.face = ax>0?1:-1;
  }

  function input(){
    if(joy.on){
      const dx = joy.ex - joy.sx;
      joySet(dx);
    }
  }

  // ==== —Ñ–∏–∑–∏–∫–∞ ====
  function physics(){
    cat.vy += G;
    cat.x  += cat.vx;
    cat.y  += cat.vy;
    cat.vx *= FRICTION;

    // –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ –ø–æ X (–∫–∞–∫ –≤ Doodle Jump)
    if (cat.x < -cat.w) cat.x = innerWidth + cat.w;
    if (cat.x > innerWidth + cat.w) cat.x = -cat.w;

    // –¥–≤–∏–∂–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º
    for(const p of plats){
      if(p.type==='move'){
        p.x += p.dir*1.2*Math.sin((performance.now()+p.off)/800);
        p.x = clamp(p.x, 10, innerWidth - p.w - 10);
      }
    }

    // —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è: –ø—Ä–∏–∑–µ–º–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–∞–¥–∞–µ–º
    if (cat.vy > 0){
      for (const p of plats){
        const y = p.y;
        if (cat.y + cat.h/2 > y && cat.y + cat.h/2 < y + 16 && cat.x > p.x && cat.x < p.x + p.w){
          // —Ç–∏–ø –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
          if (p.type==='break'){
            if (p.life>0){ p.life=0; } // –ª–æ–º–∞–µ–º –∏ –ù–ï –ø–æ–¥–ø—Ä—ã–≥–∏–≤–∞–µ–º ‚Äî –∏–≥—Ä–æ–∫ –ø—Ä–æ–ª–µ—Ç–∞–µ—Ç –≤–Ω–∏–∑
          } else if (p.type==='spring'){
            cat.vy = JUMP * 1.5; // —Å—É–ø–µ—Ä-–ø—Ä—ã–∂–æ–∫
          } else {
            cat.vy = JUMP;       // –æ–±—ã—á–Ω—ã–π –ø—Ä—ã–∂–æ–∫
          }
        }
      }
    }

    // –∫–∞–º–µ—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –≤–≤–µ—Ä—Ö
    camY = Math.min(camY, cat.y - innerHeight*0.45);
    // —Å—á—ë—Ç ‚Äî –≤—ã—Å–æ—Ç–∞
    score = Math.max(score, Math.round(-(cat.y - 0)));
  }

  // ==== –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ ====
  function drawCat(){
    const x = cat.x, y = cat.y - camY, f = cat.face, w=cat.w, h=cat.h;

    // —Ö–≤–æ—Å—Ç
    ctx.save();
    ctx.translate(x - f*w*0.35, y + h*0.05);
    ctx.rotate(Math.sin(performance.now()/150)*0.2*f);
    ctx.beginPath(); ctx.ellipse(0,0, w*0.28, h*0.18, 0, 0, Math.PI*2);
    ctx.fillStyle='#f7c38b'; ctx.fill();
    ctx.restore();

    // —Ç–µ–ª–æ
    ctx.beginPath(); ctx.roundRect(x - w*0.35, y - h*0.4, w*0.7, h*0.8, 12);
    ctx.fillStyle='#ffd9a8'; ctx.fill();

    // –ª–∞–ø—ã (–ø—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è)
    const step = Math.sin(performance.now()/120)*3;
    ctx.fillStyle='#ffc891';
    ctx.fillRect(x - w*0.28 + step*f, y + h*0.35, w*0.22, 6);
    ctx.fillRect(x + w*0.06 + step*f,  y + h*0.35, w*0.22, 6);

    // –≥–æ–ª–æ–≤–∞
    ctx.beginPath(); ctx.ellipse(x, y - h*0.55, w*0.42, h*0.33, 0, 0, Math.PI*2); ctx.fillStyle='#ffd9a8'; ctx.fill();
    // —É—à–∫–∏
    ctx.beginPath(); ctx.moveTo(x - w*0.28, y - h*0.76); ctx.lineTo(x - w*0.14, y - h*0.98); ctx.lineTo(x - w*0.02, y - h*0.70); ctx.closePath(); ctx.fillStyle='#ffb77a'; ctx.fill();
    ctx.beginPath(); ctx.moveTo(x + w*0.28, y - h*0.76); ctx.lineTo(x + w*0.14, y - h*0.98); ctx.lineTo(x + w*0.02, y - h*0.70); ctx.closePath(); ctx.fillStyle='#ffb77a'; ctx.fill();

    // –ª–∏—Ü–æ
    // –≥–ª–∞–∑–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É –¥–≤–∏–∂–µ–Ω–∏—è
    const ex = x + f*w*0.10;
    ctx.beginPath(); ctx.fillStyle='#222';
    ctx.arc(ex - w*0.12, y - h*0.58, 3.6, 0, Math.PI*2);
    ctx.arc(ex + w*0.12, y - h*0.58, 3.6, 0, Math.PI*2); ctx.fill();
    // –Ω–æ—Å
    ctx.beginPath(); ctx.arc(x, y - h*0.50, 2.4, 0, Math.PI*2); ctx.fillStyle='#e27b7b'; ctx.fill();
    // –≤–∏–∑–æ—Ä —Å–∫–∞—Ñ–∞–Ω–¥—Ä–∞
    ctx.beginPath(); ctx.arc(x, y - h*0.55, w*0.55, Math.PI*0.15, Math.PI*1.15);
    ctx.strokeStyle='rgba(130,200,255,.45)'; ctx.lineWidth=6; ctx.stroke();
    // —à–ª–µ–º
    ctx.beginPath(); ctx.ellipse(x, y - h*0.52, w*0.56, h*0.50, 0, 0, Math.PI*2);
    ctx.strokeStyle='rgba(130,200,255,.75)'; ctx.lineWidth=6; ctx.stroke();
  }

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // —Ñ–æ–Ω
    const g=ctx.createLinearGradient(0,0,0,innerHeight);
    g.addColorStop(0,'#0c1430'); g.addColorStop(1,'#091224'); ctx.fillStyle=g;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
    for(const p of plats){
      const y = p.y - camY;
      if (y<-40 || y>innerHeight+40) continue;
      if (p.type==='solid'){ ctx.fillStyle='#21d1a3'; ctx.fillRect(p.x,y,p.w,10); }
      if (p.type==='move'){ ctx.fillStyle='#2db3ff'; ctx.fillRect(p.x,y,p.w,10); }
      if (p.type==='break'){ ctx.fillStyle='#ff7676'; ctx.fillRect(p.x,y,p.w,10); ctx.fillStyle='#fff8'; ctx.fillRect(p.x,y, p.w*Math.abs(Math.sin(performance.now()/300)), 2); }
      if (p.type==='spring'){ ctx.fillStyle='#ffe36b'; ctx.fillRect(p.x,y,p.w,10);
        // –ø—Ä—É–∂–∏–Ω–∫–∞
        ctx.strokeStyle='#f5cd3a'; ctx.lineWidth=3; ctx.beginPath();
        const cx=p.x+p.w/2; ctx.moveTo(cx-10,y); ctx.lineTo(cx-5,y-8); ctx.lineTo(cx,y); ctx.lineTo(cx+5,y-8); ctx.lineTo(cx+10,y);
        ctx.stroke();
      }
    }

    // –∫–æ—Ç
    drawCat();

    // —Å—á—ë—Ç –≤ —á–∏–ø–µ
    $$('#score-chip').textContent = score;
  }

  function step(){
    if(!running) return;
    input(); physics(); ensurePlats(); draw();
    raf = requestAnimationFrame(step);
  }

  function resize(){
    canvas.width = innerWidth; canvas.height = innerHeight;
    ensurePlats();
  }

  // === –∑–∞–ø—É—Å–∫/—Å—Ç–æ–ø ===
  function start(){
    if(running) return;
    canvas=document.createElement('canvas');
    canvas.id='cat'; canvas.style.position='fixed'; canvas.style.inset='0'; canvas.style.zIndex='50'; canvas.style.touchAction='none';
    document.body.appendChild(canvas);
    ctx=canvas.getContext('2d');
    addEventListener('resize',resize); resize(); reset(); bind();
    running=true; document.body.classList.add('playing-cat'); $$('#cat-hud').classList.add('show');
    raf=requestAnimationFrame(step);
  }
  function stop(save=true){
    running=false; if(raf) cancelAnimationFrame(raf);
    removeEventListener('resize',resize);
    if(canvas) canvas.remove();
    document.body.classList.remove('playing-cat'); $$('#cat-hud').classList.remove('show');
    if(save){ const n=($$('#player-name').value||'Kosmos').slice(0,16); pushRec('kosmos_records_cat', n, score); }
  }
  window.__startCat=start; window.__stopCat=stop;

  // === —Å–æ–±—ã—Ç–∏—è ===
  on($$('#play-cat'),'click',start);
  // –Ω–µ–≤–∏–¥–∏–º—ã–π –¥–∂–æ–π—Å—Ç–∏–∫: –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —ç–∫—Ä–∞–Ω–∞
  function jStart(e){ const t=e.touches?e.touches[0]:e; joy.on=true; joy.sx=joy.ex=t.clientX; joy.sy=joy.ey=t.clientY; }
  function jMove (e){ if(!joy.on) return; const t=e.touches?e.touches[0]:e; joy.ex=t.clientX; joy.ey=t.clientY; }
  function jEnd  (){ joy.on=false; }
  // –ø–æ–¥–≤–µ—à–∏–≤–∞–µ–º –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç (–Ω–∞ canvas —Ç–æ–∂–µ –Ω–æ—Ä–º, –Ω–æ —Ç–∞–∫ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö —Å–≤–∞–π–ø–∞—Ö)
  on(document,'touchstart',jStart,{passive:true});
  on(document,'touchmove', jMove ,{passive:true});
  on(document,'touchend',  jEnd  ,{passive:true});
  on(document,'mousedown', jStart); on(document,'mousemove', jMove); on(document,'mouseup', jEnd);

  // –±–æ–ª—å—à–∏–µ —ç–∫—Ä–∞–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ ‚Äî –∫–∞–∫ –¥—É–±–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  on($$('#cat-left'),'touchstart',()=>{ joy.sx=joy.ex=(innerWidth*0.25); joy.on=true; },{passive:true});
  on($$('#cat-left'),'touchend',  ()=>{ joy.on=false; },{passive:true});
  on($$('#cat-right'),'touchstart',()=>{ joy.sx=joy.ex=(innerWidth*0.75); joy.on=true; },{passive:true});
  on($$('#cat-right'),'touchend',  ()=>{ joy.on=false; },{passive:true});
  on($$('#cat-left'),'mousedown', ()=>{ joy.sx=joy.ex=(innerWidth*0.25); joy.on=true; });
  on($$('#cat-right'),'mousedown',()=>{ joy.sx=joy.ex=(innerWidth*0.75); joy.on=true; });
  on(window,'mouseup',()=>{ joy.on=false; });

})();
</script>

<script>
/* ===== –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –∫–Ω–æ–ø–∫–∞ "–í –º–µ–Ω—é" ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±–∞ —Ä–µ–∂–∏–º–∞ ===== */
document.getElementById('btn-menu')?.addEventListener('click', ()=>{
  window.__stopWorm?.(false);
  window.__stopCat?.(false);
});
</script>
</body>
</html>